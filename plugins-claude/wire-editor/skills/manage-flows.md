# Manage Node-RED Flows

Create, import, export, and organize Node-RED flow projects in the WIRING directory.

## Quick Usage

Describe what you want: create a new project, import an external flow, export for deployment, or list available templates.

## Create Project

Provide: **project name** (kebab-case), **description**, **use case** (bot, dashboard, orchestration, feed), optional **base template**.

Creates structure:
```
ARCHIVO/DISCO/WIRING/projects/{name}/
├── flow.json          # Main flow
├── package.json       # Dependencies
└── README.md          # Documentation
```

## Import Flow

Provide: **JSON file path**, **destination** (templates/flows/, templates/subflows/, or projects/{name}/), optional **name**.

Process: Validate JSON structure, detect artifact type (tab/subflow/node), extract metadata, verify dependencies against catalog, copy to destination, update `catalog.json`.

## Export Flow

Provide: **flow ID or path**, **destination**, optional flags: `--include-subflows`, `--include-config`, `--standalone`.

Standalone export generates a full package with `flows.json`, `package.json`, and `README.md`.

---

<details>
<summary><strong>Full Documentation</strong> (click to expand)</summary>

### Create Project -- Detailed Steps

1. **Validate name**: Check no conflict in `ARCHIVO/DISCO/WIRING/projects/`
2. **Create folder**: `ARCHIVO/DISCO/WIRING/projects/{name}/`
3. **Generate initial flow.json**: From template if available, otherwise minimal tab with comment node
4. **Create README.md**: With description, use case, recommended nodes, execution instructions
5. **Update catalog.json**: Add entry to `projects` array

#### Initial flow.json (no template)

```json
{
  "id": "{uuid}",
  "type": "tab",
  "label": "{name}",
  "nodes": [],
  "configs": [],
  "comments": [
    {
      "id": "{uuid}",
      "type": "comment",
      "name": "Project generated by WireEditor",
      "info": "{description}"
    }
  ]
}
```

#### catalog.json entry

```json
{
  "id": "{name}",
  "name": "{readable name}",
  "path": "projects/{name}/",
  "description": "{description}",
  "nodes_used": [],
  "feeds": [],
  "created_at": "{ISO8601}",
  "template_base": "{template or null}"
}
```

### Import Flow -- Validation Checklist

- JSON is valid
- Has required fields (id, type)
- No ID conflict with existing artifacts
- Required nodes are available or documented
- Node types compared against catalog:
  - node-red-contrib-alephscript nodes
  - Node-RED core nodes
  - External package nodes (warned)

### Export Flow -- Standalone Package

```
{destination}/
├── flows.json
├── package.json
├── README.md
└── settings.js (optional)
```

**package.json**:
```json
{
  "name": "{name}-flow",
  "version": "1.0.0",
  "description": "Flow exported from WireEditor",
  "node-red": {
    "settings": { "flowFile": "flows.json" }
  },
  "dependencies": {
    "node-red": "^3.0.0",
    "node-red-contrib-alephscript": "^1.0.0"
  }
}
```

### Templates

Templates live in `ARCHIVO/DISCO/WIRING/templates/`:
- `flows/`: Complete flow templates
- `subflows/`: Reusable subflow components
- `nodes/`: Individual node configurations

Sync from submodule:
```bash
cp node-red-alephscript-sdk/examples/flows/*.json ARCHIVO/DISCO/WIRING/templates/flows/
```

</details>
